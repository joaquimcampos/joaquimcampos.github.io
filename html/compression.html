<h2 class="new-project">Neural Image and Video Compression</h2>

<h3 style="margin: 0;">
    <a href="https://studios.disneyresearch.com/researchlab/disney-research-zurich/">
        @DisneyResearch
    </a>
</h3>

<div class="row-compression">
    <a href="https://studios.disneyresearch.com/2019/10/27/neural-inter-frame-compression-for-video-coding/">
        <img id="video-compression" src="assets/images/video_compression.png" alt="Video Compression">
    </a>
    <div></div>
    <a href="https://openaccess.thecvf.com/content_CVPRW_2019/html/CLIC_2019/Campos_Content_Adaptive_Optimization_for_Neural_Image_Compression_CVPRW_2019_paper.html">
        <img id="img-compression" src="assets/images/image_compression.png" alt="Image Compression">
    </a>
</div>

<div class="last-element">
<p>
    Most of us are familiar with file extensions like MP3, JPEG, and MPEG. But they are not just that: They are, first and foremost, compression standards. The internet relies on them and their newer versions <a href="" ng-click="scrollToElement('footnote-compression-1')">[1]</a> in order to deliver audio, image, and video content to our devices almost instantaneously and with very little quality loss.
</p>
<p>
    Here, I will try to explain in simple terms the general idea behind compression algorithms,
    and talk briefly about the research I conducted with my colleagues at
    <a href="https://studios.disneyresearch.com/researchlab/disney-research-zurich/">Disney Research.</a>
</p>    
<h4>What is compression?</h4>
<p>
    (Story time)
</p>
<p>
    Let's imagine that your friend Sarah would like to try your already-famous homemade vegan chocolate cake.
    If you want to make sure that she tries the best possible version of the cake, it's straightforward: you bake the cake yourself,
    drive up to her house, and deliver it to her.
    This works, but it is also quite inefficient: The cake is heavy and it takes time
    to bring it to Sara's place,
    especially if you encounter heavy traffic on your way there.
</p>
<p>
<!-- </p>
<p> -->
    If you are not willing to compromise on the quality of the cake, it's hard
    to get something much more efficient than this.
    But, still, there is some room for improvement in case you want make the cake a bit lighter.
    One idea is to give Sarah the cake without any of the heavy
    store-bought toppings, like the chocolate chips, and message her a list of the toppings
    via <a href="https://www.signal.org/">Signal</a>,
    including the correct brands and amounts, and with exact indications on when and where to
    place them on the cake.
    The catch is that this also requires a bit of extra work on both sides: you need to write
    all of these details, and Sarah needs to go shopping.
</p>
<p>
    But if all of this still sounds too tiring, why don't you write down all the steps required to
    bake your cake, A.K.A. the recipe, and send it to Sarah? Much better! A recipe only occupies a few Megabytes of space, therefore it is much faster to send.
    But, of course, even though the cake is free, there is <a href="https://en.wikipedia.org/wiki/No_free_lunch_theorem">no free lunch</a>: Now you need to accept that the end result won't be exactly like yours, especially if Sarah does not bake as well as you.
    But it's worth it if you want to save some time. (Actually, a lot of time!)
    And if you receive 50 other cake requests,
    forwarding a message with a few Megabytes is a much better strategy than baking
    50 other cakes.
</p>
<p>
    Now, we've already found a good solution. But let's say that Sarah and 50 other friends
    all ask you for the recipe at a party (because why not?).
    You promise them that you'll write down the recipe and send it later,
    but you only have 30 MB left on your internet budget, so you really need to save space!
    An idea is to take advantage of the fact that, at that moment, you can
    agree on some things: "One tablespoon" will be written as "1 Tbsp",
    "half teaspoon" as "1/2 tsp", "1 pack of oatmilk
    from <a href="https://www.oatly.com/en">Oatly</a>" as
    "1 milk" (no, I don't receive any money from them &#128516;).
    In this way, you can shorten the size of your recipe and fall within your internet plan.
</p>
<p>
    (End of story)
</p>
<p>
    I will now explain all of these ideas in the language of compression.
</p>
<p>
    In the first two versions of the story, the quality of the cake was the best possible.
    Still, in the second version, you were able to carry a lighter cake at the small expense
    of a message with the list of toppings that took you 10 minutes to right down.
    Because you were able to save space
    without loosing any quality&mdash;provided that Sarah can follow the instructions correctly&mdash;
    you actually performed <i>lossless compression</i>.
</p>
    Lossless compression can only go up to a certain point, though.
    The alternative is to allow some loss of quality
    for the sake of saving a lot of space and time. This is known as (you guessed it...) <i>lossy compression</i>.
    The idea here is that you're the <i>encoder</i>&mdash;you encode your chocolate cake into a recipe (the compressed information)&mdash;, and your friend is the <i>decoder</i>&mdash;she takes the compressed information (the recipe) and attempts her best <i>reconstruction</i> of your cake.
    The quality will depend on how well you can summarize the recipe and how well your friend can reconstruct it.
    If, on one hand, your recipe is very detailed, it will be very long and take a lot of time to send.
    If, on the other hand, you try to summarize your recipe in very few steps, although you'll be able to send it faster,
    the quality of the end-result will suffer.
    So we need to strike a balance between the space occupied&mdash;which impacts the speed of transmission&mdash;and the reconstruction quality. 
    This fundamental trade-off is called the
    <a href="https://en.wikipedia.org/wiki/Rate%E2%80%93distortion_theory">Rate-Distortion curve</a>
    (you can see one such curve <a href="" ng-click="scrollToElement('img-compression')">above</a>):
    It essentially tells us that if you wish to write down your chocolate cake recipe in two lines, you can,
    but don't except your friend to come up with anything similar to your home-made cake.
    A good way to compare compression algorithm is by comparing the reconstruction quality
    for the same recipe length (as
    in <a href="" ng-click="scrollToElement('img-compression')">above</a>).
</p>
<p>
    The internet has "roads" that can be pretty congested.
    If you request a film from Netflix at 1080p, they could send you the RGB values
    of each of the 2,073,600 pixels of each of the 130,000 frames of the film.
    (This is the equivalent of the first scenario.)
    But that's roughly 809 GB of information (almost 1 TB), so you'd have to wait for a while &#x23F1;.
    The opposite scenario is the movie downloading almost instantly, but the quality being very low.
    Neflix movies at 360p are not so fun to watch. All in all, we need a balance between these two cases.
</p>
<h4 style="margin-top: 40px">Video Compression</h4>
    How can we translate all of this to video?
    Well, videos are made of frames that oftentimes don't change
    much (we say that there is a lot of redundancy in the signal).
    Therefore, if you have an almost static scene
    for 2 seconds, a simple way to compress is to just encode the first frame and
    then send a small piece of information that
    says "The next 47 frames are the same". You can even drop some frames and do <a href="https://en.wikipedia.org/wiki/Stop_motion">stop-motion</a>!
    A much more sophisticated version, which is used in all codecs today,
    is to encode key frames on their own, called intra-frames, and then encode
    just the differences in motion on frames that are close-by relative to this frame.
</p>
<h4 style="margin-top: 40px">The First Project, Simply Explained</h4>
<p>

    First, alongside the recipe, we send another recipe with some side information
    (motion information and blending coefficients)
    that will then be used by our friend to help her reconstruct the cake.
    But most importantly, before sending new recipes, we train for two weeks at our place with
    our friend trying out different recipes, so we
    know our friend's cooking style and the kind of mistakes she makes (so the training
    is end-to-end).
    Then, when it's time to send a new recipe, I can understand where my friend will
    have trouble. So what I do is to send another recipe with annotations for her
    to correct the mistakes,
    The decoder (your friend) takes the original recipe, the side information recipe,
    and the errata recipe, and puts them all together.
</p>
<p>
    The top-left image
    on the <a href="" ng-click="scrollToElement('img-compression')">top of this page
    </a> shows our results.
</p>
<h4 style="margin-top: 40px">The Second Project, Simply Explained</h4>
<p>
    In the second project we found a way to optimize a new recipe without
    having to exchange new information between the encoder and the decoder,
    just by tweaking the recipe itself and not changing its length.
    Knowing the information that I have and knowing the information my friend has,
    I can tweak the recipe in a way that I will either improve the quality or reduce
    the space, compared to a baseline scenario where I just generate the recipe (encode
    it) and don't tweak it. So our method is content-adaptive.
    The downside is that it takes a bit more time, but if we wish to send the recipe
    to several people, and what matters
    is not how much time I take to write it but how fast I can send it when my friend
    requests it and how fast they can recreate the cake, it's totally worth it.
    When Netflix gets a new film, it doesn't really matter if they take an hour
    more to compress it, if it will be faster to download when the users request it
    and the quality is improved!
</p>
<p> 
    The top-right image
    on the <a href="" ng-click="scrollToElement('img-compression')">top of this page
    </a> shows our results.
</p>
<h4 style="margin-top: 40px">Impact</h4>
<p>
Both works achieved state-of-the-art results at the time of publication;
together, they led to the registration of three US patents
[<a href="https://image-ppubs.uspto.gov/dirsearch-public/print/downloadPdf/10972749">1</a>, 
 <a href="https://image-ppubs.uspto.gov/dirsearch-public/print/downloadPdf/11012718">2</a>, 
 <a href="https://image-ppubs.uspto.gov/dirsearch-public/print/downloadPdf/11057634">3</a>].

The work on video compression has been cited over 140 times, including in publications from
<a href="https://openaccess.thecvf.com/content/CVPR2021/papers/Wang_One-Shot_Free-View_Neural_Talking-Head_Synthesis_for_Video_Conferencing_CVPR_2021_paper.pdf">
Nvidia</a>,
Google [<a href="https://openaccess.thecvf.com/content_CVPR_2020/papers/Agustsson_Scale-Space_Flow_for_End-to-End_Optimized_Video_Compression_CVPR_2020_paper.pdf">1</a>,
<a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=9242247">2</a>],
and
<a href="https://proceedings.neurips.cc/paper_files/paper/2021/
file/96b250a90d3cf0868c83f8c965142d2a-Paper.pdf">
Microsoft</a>.

The work on image compression has been cited over 30 times, including in publications from
<a href="https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=9242247">Google</a>,
<a href="https://arxiv.org/abs/2103.03123">University of Oxford</a>,
<a href="https://proceedings.neurips.cc/paper_files/paper/2020/file/
066f182b787111ed4cb65ed437f0855b-Paper.pdf">
UC Irvine</a>, <!-- (IMPORTANT) -->
<a href="https://openreview.net/pdf?id=IDwN6xjHnK8">
Qualcomm</a>,
<a href="https://arxiv.org/pdf/2008.09180.pdf">
Uber</a>, <!-- (CLOSE TO US) -->
<a href="https://openaccess.thecvf.com/content/CVPR2021W/CLIC/papers/Zhao_A_Universal_Encoder_Rate_Distortion_Optimization_Framework_for_Learned_Compression_CVPRW_2021_paper.pdf">
Microsoft</a>, <!-- (Important) -->
Nokia
[<a href="https://arxiv.org/pdf/2007.16054.pdf">1</a>,
<a href="https://arxiv.org/pdf/2108.09992.pdf">2</a>], and
<a href="https://openaccess.thecvf.com/content_CVPRW_2020/papers/w7/Guo_Variable_Rate_Image_Compression_With_Content_Adaptive_Optimization_CVPRW_2020_paper.pdf">
Huawei</a>.
</p>
<p style="margin-top: 20px; margin-bottom: 10px">
    <b>Publications</b>
</p>
<div ng-controller="DisneyPubsCtrl">
    <pubs-no-headers></pubs-no-headers>
</div>

<p style="margin-top: 20px; margin-bottom: 10px">
    <b>Patents</b>
</p>
<div ng-controller="DisneyPatentsCtrl">
    <pubs-no-headers></pubs-no-headers>
</div>

<h4 class="subsection">Technologies</h4>
<p>
    Here I outline a few technologies that I used in these projects.
    <ul>
        <li><a href="https://www.python.org/">Python</a>: Programming language.</li>
        <li><a href="https://pytorch.org/">Pytorch</a>: Deep learning framework.</li>
        <li><a href="https://www.gnu.org/software/bash/">Bash</a>: Unix shell and command language.</li>
    </ul>
</p>

<hr style="margin-top: 40px;">
<h5>Footnotes</h5>
<p style="margin-bottom: 0px;" id="footnote-compression-1">
    [1] Some examples of sophisticated video codecs that evolved from MPEG are
    H.265/HEVC, VP9, and AV1. The latter is used by Netflix.
</p>

</div>  <!-- last element -->
